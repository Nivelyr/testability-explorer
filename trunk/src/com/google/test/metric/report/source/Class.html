<html>
  <style type="text/css">
    .source {
	font-size: 12px;
	border: thin solid #000000;
	width: 100%;
	}
	
	.ln {
	background-color: #CCCCCC;
	text-align: right;
	padding-left: 3px;
	padding-right: 3px;
	width: 50;
	border-right: thin solid #000000;
	}

	.head {
	background-color: #CCCCCC;
	padding-left: 3px;
	padding-right: 3px;
	width: 50;
	font-weight:bold;
	border-right: thin solid #000000;
	border-bottom: thin solid #000000
	}
	
	.code {
	padding-right: 3px;	
	padding-left: 3px;	
	border-right: thin solid #000000;
	}
	
	.score, .summary, .metric {
	padding-right: 3px;	
	padding-left: 3px;	
	width: 100;
	border-right: thin solid #000000;
	}
	
	.summary {
	font-weight:bold;
	font-style:italic;
	}

	.metric {
	font-weight:bold;
	}

}
  .summary1 {	font-weight:bold;
	font-style:italic;
}
  </style>
  <title>Testability Explorer Report for class: ${classCost.className}</title>
<#function code text>
  <#return "<tt>" + text?html?replace(' ', '&nbsp;') +"</tt>">
</#function>
<#function color value>
  <#if (value <= maxExcelentCost) >
    <#return "style='background-color:#00FF00'">
  <#elseif (value <= maxAcceptableCost)>
    <#return "style='background-color:#FFFF00'">
  <#else>
    <#return "style='background-color:#FF0000'">
  </#if>  
</#function>
<body>
<h1><tt>${classCost.className}</tt></h1>
<table class="source" cellspacing="0" cellpadding="0">
  <tr>
    <td class="head" width="100">Metric:</td>
    <td class="head" width="100">Value:</td>
    <td class="head" colspan="2" width="100%">Chart:</td>
  </tr>
  <tr>
    <td class="metric">Class cost:</td>
    <td class="score" ${color(overallCost)}>${overallCost}</td>
    <td rowspan="2" align="center" class="score" style="border-right:none">${overallCostChart}</td>
    <td class="score" rowspan="7">${histogramChart}</td>
  </tr>
  <tr>
    <td class="score">&nbsp;</td>
    <td class="score">&nbsp;</td>
  </tr>
  <tr>
    <td class="metric">Method(s) count:</td>
    <td class="score">${methodCosts?size}</td>
    <td rowspan="5" align="center" class="score" style="border-right:none">${distributionChart}</td>
  </tr>
  <tr>
    <td class="metric">&nbsp;&nbsp;&nbsp;Excelent:</td>
    <td class="score" style="background-color:#00FF00">${excelentCount} [${(excelentCount/(methodCosts?size))?string.percent}]</td>
  </tr>
  <tr>
    <td class="metric">&nbsp;&nbsp;&nbsp;Good:</td>
    <td class="score" style="background-color:#FFFF00">${goodCount} [${(goodCount/(methodCosts?size))?string.percent}]</td>
  </tr>
  <tr>
    <td class="metric">&nbsp;&nbsp;&nbsp;Needs work:</td>
    <td class="score" style="background-color:#FF0000">${needsWorkCount} [${(needsWorkCount/(methodCosts?size))?string.percent}]</td>
  </tr>
  <tr>
    <td class="score">&nbsp;</td>
    <td class="score">&nbsp;</td>
  </tr>
</table>
<br>
<table class="source" cellspacing="0" cellpadding="0">
  <tr>
    <td class="head">Method</td>
    <td class="head">Total Cost</td>
    <td class="head">Direct Cost</td>
  </tr>
  <#list classCost.methods?sort_by(["totalCost", "overall"]) as method>
  <tr>
    <td class="score" ${color(method.totalCost.overall)}><a href="#${method.methodLineNumber}"><tt>${method.methodName}</tt></a></td>
    <td class="score" ${color(method.totalCost.overall)}>${method.totalCost}&nbsp;</td>
    <td class="score" ${color(method.totalCost.overall)}>${method.cost}&nbsp;</td>
  </tr>
  </#list>
</table>
<br>
<table class="source" cellspacing="0" cellpadding="0">
  <tr>
    <td class="head">Line&nbsp;No:</td>
    <td class="head">Cost</td>
    <td class="head">Source Code</td>
  </tr>
  <#list source.lines as line>
    <#list line.methodCosts as method>
      <tr>
        <td class="ln"><a name="${line.lineNumber}"/>&nbsp;</td>
        <td nowrap class="summary" ${color(method.totalCost.overall)}>${method.totalCost}&nbsp;</td>
        <td nowrap class="summary" ${color(method.totalCost.overall)}>${code(method.methodName)}<br>
          Total: ${method.totalCost}&nbsp;Direct: ${method.cost}&nbsp;
        </td>
  </tr>
    </#list>
    <tr>
      <td class="ln"><a name="${line.lineNumber}"/>${line.lineNumber}</td>
      <td nowrap class="score">${line.score}&nbsp;</td>
      <td nowrap class="code">${code(line.text)}&nbsp;</td>
    </tr>
  </#list>
</table>
</body>
</html>